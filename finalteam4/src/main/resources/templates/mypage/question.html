<meta charset="utf-8">
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<style>
.navigation {
	position: relative;
}

#wrapper ul li a:hover {
	color: tomato;
	font-weight: 600;
}
/* Sidebar */
#sidebar-wrapper {
	z-index: 1;
	position: absolute;
	width: 0;
	height: 150%;
	overflow-y: hidden;
	opacity: 0.9;
	transition: all .5s;
	display: flex;
	padding-left: 40px;
}

/* Main Content */
#page-content-wrapper {
	width: 100%;
	padding: 15px;
	transition: all .5s;
}

#menu-toggle {
	transition: all .3s;
	font-size: 2em;
}
/* Change the width of the sidebar to display it*/
#wrapper.menuDisplayed #sidebar-wrapper {
	width: 250px;
}

#wrapper.menuDisplayed #page-content-wrapper {
	padding-left: 250px;
}

/* Sidebar styling */
.sidebar-nav {
	padding: 0;
	list-style: none;
	transition: all .5s;
	width: 100%;
	text-align: center;
}

.sidebar-nav li {
	line-height: 40px;
	width: 100%;
	transition: all .3s;
	padding: 10px 0;
}

.sidebar-nav li a {
	font-size: 15px;
	color: #5d5d5d;
	font-weight: 200;
}

.sidebar-nav li h4 {
	font-size: 17px;
	line-height: 26px;
	font-weight: 800;
	color: #303033;
}

/* .sidebar-nav li {
	
} */
.footer-style-3 {
	display: none;
}

.weather-card {
	margin: 0px auto;
	height: 180px;
	width: 1000px;
	background: #fff;
	box-shadow: 0 1px 38px rgba(0, 0, 0, 0.15), 0 5px 12px
		rgba(0, 0, 0, 0.25);
	overflow: hidden;
}

.weather-card .top {
	position: relative;
	height: 220px;
	width: 100%;
	overflow: hidden;
	background: url("/img/mypage_recent.jpg") no-repeat;
	background-size: cover;
	background-position: center center;
	text-align: center;
	background-size: cover;
}

.weather-card .top .wrapper {
	padding: 0px;
	position: relative;
	z-index: 1;
	width: 50%;
	float: right;
}

.weather-card .top .wrapper2 {
	padding: 0px;
	position: relative;
	z-index: 1;
	width: 50%;
	float: left;
}

.weather-card .top .wrapper .mynav {
	height: 10px;
}

.weather-card .top .wrapper .mynav .lnr {
	color: #fff;
	font-size: 20px;
}

.weather-card .top .wrapper .mynav .lnr-chevron-left {
	display: inline-block;
	float: left;
}

.weather-card .top .wrapper .mynav .lnr-cog {
	display: inline-block;
	float: right;
}

.weather-card .top .wrapper .heading {
	margin-top: 10px;
	font-size: 35px;
	font-weight: 400;
	color: #fff;
}

.weather-card .top .wrapper .location {
	margin-top: 20px;
	font-size: 20px;
	color: #fff;
}

.weather-card .top .wrapper .temp {
	margin-top: 20px;
}

.weather-card .top .wrapper .temp a {
	text-decoration: none;
	color: #fff;
}

.weather-card .top .wrapper .temp a .temp-type {
	font-size: 85px;
}

.weather-card .top .wrapper .temp .temp-value {
	display: inline-block;
	font-size: 50px;
	color: #fff;
}

.weather-card .top .wrapper .temp .deg {
	display: inline-block;
	font-size: 35px;
	font-weight: 600;
	color: #fff;
	vertical-align: top;
	margin-top: 10px;
}

.weather-card .top:after {
	content: "";
	height: 100%;
	width: 100%;
	display: block;
	position: absolute;
	top: 0;
	left: 0;
	background: rgba(0, 0, 0, 0.5);
}

.weather-card .top .wrapper2 .mynav {
	height: 20px;
}

.weather-card .top .wrapper2 .mynav .lnr {
	color: #fff;
	font-size: 20px;
}

.weather-card .top .wrapper2 .mynav .lnr-chevron-left {
	display: inline-block;
	float: left;
}

.weather-card .top .wrapper2 .mynav .lnr-cog {
	display: inline-block;
	float: right;
}

.weather-card .top .wrapper2 .heading {
	margin-top: 10px;
	font-size: 35px;
	font-weight: 400;
	color: #fff;
}

.weather-card .top .wrapper2 .location {
	margin-top: 20px;
	font-size: 20px;
	color: #fff;
}

.weather-card .top .wrapper2 .temp {
	margin-top: 20px;
}

.weather-card .top .wrapper2 .temp a {
	text-decoration: none;
	color: #fff;
}

.weather-card .top .wrapper2 .temp a .temp-type {
	font-size: 85px;
}

.weather-card .top .wrapper2 .temp .temp-value {
	display: inline-block;
	font-size: 50px;
	color: #fff;
}

.weather-card .top .wrapper2 .temp .deg {
	display: inline-block;
	font-size: 35px;
	font-weight: 600;
	color: #fff;
	vertical-align: top;
	margin-top: 10px;
}

.question {
	margin: 0px auto;
	height: 220px;
	width: 1200px;
	padding-top: 50px;
}

.my_tit {
	position: relative;
	padding-bottom: 10px;
	border-bottom: 4px solid #000;
}

.my_tit span {
	display: inline-block;
	margin-left: 10px;
	font-size: 18px;
	font-weight: 400;
}

.btn_next {
	padding-top: 30px;
	border-top: 1px solid #d4d4d4;
	text-align: center;
}

.btn_next button {
	width: 300px;
	height: 50px;
	margin: 0 auto;
	background: #000;
	border-color: #000;
	font-weight: 700;
	font-size: 18px;
	font-weight: 700;
}

#chat1 .form-outline .form-control ~.form-notch div {
	pointer-events: none;
	border: 1px solid;
	border-color: #eee;
	box-sizing: border-box;
	background: transparent;
}

#chat1 .form-outline .form-control ~.form-notch .form-notch-leading {
	left: 0;
	top: 0;
	height: 100%;
	border-right: none;
	border-radius: .65rem 0 0 .65rem;
}

#chat1 .form-outline .form-control ~.form-notch .form-notch-middle {
	flex: 0 0 auto;
	max-width: calc(100% - 1rem);
	height: 100%;
	border-right: none;
	border-left: none;
}

#chat1 .form-outline .form-control ~.form-notch .form-notch-trailing {
	flex-grow: 1;
	height: 100%;
	border-left: none;
	border-radius: 0 .65rem .65rem 0;
}

#chat1 .form-outline .form-control:focus ~.form-notch .form-notch-leading
	{
	border-top: 0.125rem solid #39c0ed;
	border-bottom: 0.125rem solid #39c0ed;
	border-left: 0.125rem solid #39c0ed;
}

#chat1 .form-outline .form-control:focus ~.form-notch .form-notch-leading,
	#chat1 .form-outline .form-control.active ~.form-notch .form-notch-leading
	{
	border-right: none;
	transition: all 0.2s linear;
}

#chat1 .form-outline .form-control:focus ~.form-notch .form-notch-middle
	{
	border-bottom: 0.125rem solid;
	border-color: #39c0ed;
}

#chat1 .form-outline .form-control:focus ~.form-notch .form-notch-middle,
	#chat1 .form-outline .form-control.active ~.form-notch .form-notch-middle
	{
	border-top: none;
	border-right: none;
	border-left: none;
	transition: all 0.2s linear;
}

#chat1 .form-outline .form-control:focus ~.form-notch .form-notch-trailing
	{
	border-top: 0.125rem solid #39c0ed;
	border-bottom: 0.125rem solid #39c0ed;
	border-right: 0.125rem solid #39c0ed;
}

#chat1 .form-outline .form-control:focus ~.form-notch .form-notch-trailing,
	#chat1 .form-outline .form-control.active ~.form-notch .form-notch-trailing
	{
	border-left: none;
	transition: all 0.2s linear;
}

#chat1 .form-outline .form-control:focus ~.form-label {
	color: #39c0ed;
}

#chat1 .form-outline .form-control ~.form-label {
	color: #bfbfbf;
}

#connect {
	width: 96px;
	font-size: 18px;
	background: #FFBB45;
	border: none;
}

#sendme {
	float: right;
	width: 96px;
	line-height: 32px;
	font-size: 18px;
	background: #FFBB45;
	border: none;
}

</style>

<script>
	$(document).ready(function() {
		const menu = document.querySelector('#menu-toggle')

		$("#menu-toggle").click(function(e) {
			e.preventDefault();
			$("#wrapper").toggleClass("menuDisplayed");
			/*클릭시 숨김  */
			menu.style.display = 'none';
		});

		$("#connect").click(function() {
			connect();
		});

		$("#disconnect").click(function() {
			disconnect();
		});

		$("#sendme").click(function() {
			sendMe();
		});

		$("#sendto").click(function() {
			sendTo();
		});
	});

	var stompClient = null;
	var id = "[[${session.logincust.custid}]]";
	// 서버소켓에 연결
	function connect() {
		var socket = new SockJS("/ws");
		stompClient = Stomp.over(socket);

		stompClient.connect({}, function(frame) {
			setConnected(true);
			console.log('Connected: ' + frame);
			stompClient.subscribe('/send/' + id, function(msg) {
				$("#card-body").append(
						"<div class='d-flex flex-row justify-content-end mb-4'><div class='p-3 me-3 border' style='border-radius: 15px; background-color: #fbfbfb'><p>" + JSON.parse(msg.body).content1 + "</p></div><img src='/assets/images/thumbnail.png' style='width: 45px; height: 100%'></div>");
				$("#card-body").append(
						"<div class='d-flex flex-row justify-content-start mb-4'><img src='/assets/images/eLogo.png' style='width: 45px; height: 100%''><div class='p-3 ms-3' style='border-radius: 15px; background-color: rgba(57, 192, 237, .2)'><p>" + JSON.parse(msg.body).content2 + "</p></div></div>");
			});
		});
	}

	// 서버소켓에 연결끊기
	function disconnect() {
		if (stompClient !== null) {
			stompClient.disconnect();
		}
		setConnected(false);
		console.log("Disconnected");
	}

	// connect&disconnect버턴 활성화/비활성화
	function setConnected(connected) {
		if (connected) {
			$("#status").text("Connected");
			$("#metext").attr("disabled", false);
		} else {
			$("#status").text("Disconnected");
		}

	}

	// 서버에 메세지 요청 메서드
	function sendMe() {
		var msg = JSON.stringify({
			'sendid' : id,
			'content1' : $('#metext').val()
		});
		stompClient.send("/receiveme", {}, msg);
	}
	
</script>

<div id="wrapper">
	<!-- Sidebar -->
	<div id="sidebar-wrapper">
		<ul class="sidebar-nav">
			<li><a th:text="${session.logincust.custname}"
				style="padding: 20px 0 10px 0; font-size: 40px; font-weight: 700"></a></li>
			<li><h4 href="#">나의 EAT & OUT 정보</h4></li>
			<li><a
				th:href="@{/mypage/order(id=${session.logincust.custid})}">테이블
					조회</a></li>
			<li><a
				th:href="@{/mypage/review(id=${session.logincust.custid})}">나의
					리뷰</a></li>
			<li><a
				th:href="@{/mypage/wishlist(id=${session.logincust.custid})}">나의
					위시리스트</a></li>
			<li><h4 href="#">나의 계정설정</h4></li>
			<li><a th:href="@{/mypage/edit(id=${session.logincust.custid})}">회원정보수정</a></li>
			<li><a href="#">회원등급</a></li>
			<li><a href="#">쿠폰</a></li>
			<li><h4 href="#">고객센터</h4></li>
			<li><a href="#">1:1 문의내역</a></li>
			<li><a href="#">공지사항</a></li>
			<li><a href="#">FAQ</a></li>
		</ul>
	</div>

	<!-- Page Content -->
	<div id="page-content-wrapper">
		<div class="container-fluid">
			<div class="row">
				<div class="col-lg-12">
					<a href="#" class="btn" id="menu-toggle">메뉴 ></a>
					<div class="weather-card one" th:with="list1 = ${session.list_one}">
						<div class="top">
							<div class="wrapper">
								<div class="mynav"></div>
								<h1 class="heading" th:text="${list1.storename}"></h1>
								<h3 class="location" th:text="${list1.reservedate}"></h3>
								<p class="temp">
									<span class="temp-value" th:text="${session.banner_rsvdate}"></span>
								</p>
							</div>
							<div class="wrapper2">
								<div class="mynav"></div>
								<h2 class="heading">가까운 예약</h2>
								<h2 class="heading" th:text="'D' + ${session.banner_dday}"></h2>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="question">
			<h3 class="my_tit">
				1 : 1 문의<span>채팅을 통해 문의를 남겨주세요.</span>
				<button id="connect" class="btn btn-default">대화시작</button>
			</h3>
			<div class="container py-5">

				<div class="row d-flex justify-content-center">
					<div class="col-md-8 col-lg-6 col-xl-4">

						<div class="card" id="chat1" style="border-radius: 15px;">
							<div
								class="card-header d-flex justify-content-between align-items-center p-3 bg-info text-white border-bottom-0"
								style="border-top-left-radius: 15px; border-top-right-radius: 15px">
								<i class="fas fa-angle-left"></i>
								<p class="mb-0 fw-bold">Eat & Out</p>
								<i class="fas fa-times"></i>
							</div>
							<div id="card-body" class="card-body">
								<div class="d-flex flex-row justify-content-start mb-4">
									<img src="/assets/images/eLogo.png"
										style="width: 45px; height: 100%">
									<div class="p-3 ms-3"
										style="border-radius: 15px; background-color: rgba(57, 192, 237, .2)">
										<p>궁금하신 점 있으신가요? </p>
										<p>저에게 물어봐주세요!</p>
									</div>
								</div>
							</div>
							<div class="form-outline">
								<textarea class="form-control" id="metext" rows="3" disabled></textarea>
								<button id="sendme">></button>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>